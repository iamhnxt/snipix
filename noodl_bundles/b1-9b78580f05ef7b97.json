[{"name":"/Start Page","nodes":[{"id":"a4b7e4d4-c01d-1267-30b6-c2b448b90067","type":"Page","parameters":{},"ports":[],"children":[{"id":"9b6a2abd-0aee-6c3c-fdbc-9e1de459b610","type":"Group","parameters":{"rowGap":{"value":20,"unit":"px"},"justifyContent":"center"},"ports":[],"children":[{"id":"226c447c-5409-2119-c9e0-4c768f5156dc","type":"Group","parameters":{"alignItems":"center","sizeMode":"contentHeight","paddingTop":{"value":40,"unit":"px"},"rowGap":{"value":10,"unit":"px"}},"ports":[],"children":[{"id":"fcfbc04f-65ce-bf80-9c09-6cdca911f3fe","type":"Text","parameters":{"alignX":"center","alignY":"center","textAlignX":"center","textStyle":"Display","text":"Meet Snipix 👋🏽","sizeMode":"contentSize"},"ports":[],"children":[]},{"id":"cd061403-630a-b1ea-3403-9d8625bec8e0","type":"Text","parameters":{"sizeMode":"contentHeight","text":"Your one time, all favourite image compressor","textAlignX":"center"},"ports":[],"children":[]},{"id":"fa109cba-9e02-4bde-b3c1-532ccd9678db","type":"net.noodl.controls.button","parameters":{"label":"Upload Photo","borderRadius":{"value":8,"unit":"px"}},"ports":[],"children":[]}]},{"id":"db609436-a532-c3d5-90d4-e0d8ba4ddb5d","type":"Group","parameters":{"alignItems":"center","rowGap":{"value":10,"unit":"px"},"sizeMode":"contentHeight"},"ports":[],"children":[{"id":"a96f0679-098f-5c75-0aa0-8da6fd6ad872","type":"Image","parameters":{"sizeMode":"explicit","width":{"value":300,"unit":"px"},"height":{"value":300,"unit":"px"}},"ports":[],"children":[]},{"id":"0620917e-685c-edd6-5dfd-c1879a338f0d","type":"Group","parameters":{"flexDirection":"row","sizeMode":"contentHeight","justifyContent":"center","columnGap":{"value":10,"unit":"px"}},"ports":[],"children":[{"id":"d932afd6-2bdd-5e05-ed5c-e075184bf374","type":"net.noodl.controls.button","parameters":{"label":"Download","borderRadius":{"value":8,"unit":"px"},"backgroundColor":"Success"},"ports":[],"children":[]},{"id":"eb761d96-243d-1106-18f7-c6d7d03e051c","type":"net.noodl.controls.button","parameters":{"label":"Clear","borderRadius":{"value":8,"unit":"px"},"backgroundColor":"Danger","sizeMode":"explicit","width":{"value":100,"unit":"px"}},"ports":[],"children":[]}]}]}]}]},{"id":"10fa011a-db2f-e573-47e6-ed69e091fbc1","type":"PageInputs","parameters":{},"ports":[],"children":[]},{"id":"6d6b1d2a-0a4f-0f54-e8a7-5f5b75b3c5b3","type":"/Reuseables--0/image compressor","parameters":{},"ports":[],"children":[]},{"id":"4fb67551-badd-82a5-72b4-33bcdc0b14a6","type":"Open File Picker","parameters":{"acceptedFileTypes":".png, .jpg, .jpeg"},"ports":[],"children":[]},{"id":"83798d38-3d67-2fd9-e463-dea03035374a","type":"JavaScriptFunction","parameters":{"functionScript":"const saveImage = async (imageBlob, filename) => {\r\n    const url = URL.createObjectURL(imageBlob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = filename; // Specify the filename for download\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    document.body.removeChild(a);\r\n    URL.revokeObjectURL(url); // Free memory\r\n};\r\n\r\nconst handleImageInput = async (imageUrl, fileInput) => {\r\n    let imageBlob;\r\n\r\n    if (imageUrl) {\r\n        // Fetch image from URL\r\n        const response = await fetch(imageUrl);\r\n        imageBlob = await response.blob();\r\n    } else if (fileInput) {\r\n        // Get the image from file input\r\n        imageBlob = fileInput;\r\n    } else {\r\n        alert('Please provide an image URL or upload a file.');\r\n        return;\r\n    }\r\n\r\n    // Save the image to the user's device\r\n    const filename = fileInput ? fileInput.name : 'downloaded_image.png'; // Use uploaded file name or default\r\n    await saveImage(imageBlob, filename);\r\n};\r\n\r\n// Usage Example:\r\n// handleImageInput(yourImageUrl, yourFileInput.files[0]);\r\nhandleImageInput(Inputs.fileurl, Inputs.file)"},"ports":[{"name":"in-fileurl","displayName":"fileurl","plug":"input","type":"*","group":"Inputs","index":4},{"name":"in-file","displayName":"file","plug":"input","type":"*","group":"Inputs","index":5}],"children":[]},{"id":"7db23ddd-8dcb-4e8c-6808-47360a9bd954","type":"/Reuseables--0/misc/hard refresh","parameters":{},"ports":[],"children":[]}],"connections":[{"sourceId":"fa109cba-9e02-4bde-b3c1-532ccd9678db","sourcePort":"onClick","targetId":"4fb67551-badd-82a5-72b4-33bcdc0b14a6","targetPort":"open"},{"sourceId":"4fb67551-badd-82a5-72b4-33bcdc0b14a6","sourcePort":"file","targetId":"6d6b1d2a-0a4f-0f54-e8a7-5f5b75b3c5b3","targetPort":"file"},{"sourceId":"4fb67551-badd-82a5-72b4-33bcdc0b14a6","sourcePort":"success","targetId":"6d6b1d2a-0a4f-0f54-e8a7-5f5b75b3c5b3","targetPort":"Run"},{"sourceId":"6d6b1d2a-0a4f-0f54-e8a7-5f5b75b3c5b3","sourcePort":"image_url","targetId":"a96f0679-098f-5c75-0aa0-8da6fd6ad872","targetPort":"src"},{"sourceId":"d932afd6-2bdd-5e05-ed5c-e075184bf374","sourcePort":"onClick","targetId":"83798d38-3d67-2fd9-e463-dea03035374a","targetPort":"run"},{"sourceId":"6d6b1d2a-0a4f-0f54-e8a7-5f5b75b3c5b3","sourcePort":"image_url","targetId":"83798d38-3d67-2fd9-e463-dea03035374a","targetPort":"in-fileurl"},{"sourceId":"6d6b1d2a-0a4f-0f54-e8a7-5f5b75b3c5b3","sourcePort":"image_file","targetId":"83798d38-3d67-2fd9-e463-dea03035374a","targetPort":"in-file"},{"sourceId":"d932afd6-2bdd-5e05-ed5c-e075184bf374","sourcePort":"boundingWidth","targetId":"eb761d96-243d-1106-18f7-c6d7d03e051c","targetPort":"width"},{"sourceId":"eb761d96-243d-1106-18f7-c6d7d03e051c","sourcePort":"onClick","targetId":"7db23ddd-8dcb-4e8c-6808-47360a9bd954","targetPort":"Run"}],"ports":[],"roots":["a4b7e4d4-c01d-1267-30b6-c2b448b90067"]},{"name":"/Reuseables--0/image compressor","nodes":[{"id":"6f60f65d-c6e1-2b35-2bb7-2363ad6ca194","type":"JavaScriptFunction","parameters":{"functionScript":"const compressImage = async (file) => {\r\n    const maxSizeMB = Inputs.max_file_size || 1; // Max file size in MB\r\n    const options = {\r\n        maxSizeMB: maxSizeMB, \r\n        useWebWorker: true,\r\n    };\r\n\r\n    try {\r\n        const compressedFile = await imageCompression(file, options);\r\n\r\n        // Check if the compressed file size is still within the limits\r\n        if (compressedFile.size > maxSizeMB * 1024 * 1024) {\r\n            Outputs.Failure();\r\n            Outputs.error(\"Compressed file is larger than the allowed size\");\r\n            return;\r\n        }\r\n\r\n        // Create a URL for the image to display it\r\n        const reader = new FileReader();\r\n        reader.onloadend = function(e) {\r\n            Outputs.Success(); // Trigger success\r\n            Outputs.response = compressedFile; // Pass the compressed file for further processing (uploading)\r\n            Outputs.imageUrl = e.target.result; // Pass the image URL to display in the Image Node\r\n        };\r\n        \r\n        reader.onerror = function() {\r\n            Outputs.Failure(); // Handle error on file reading\r\n            Outputs.error(\"Error reading the compressed file\");\r\n        };\r\n\r\n        reader.readAsDataURL(compressedFile); // Read the compressed image as a Data URL\r\n\r\n    } catch (error) {\r\n        Outputs.Failure();\r\n        Outputs.error(error.message);\r\n    }\r\n};\r\n\r\n// Call the compress function with the input file\r\ncompressImage(Inputs.file);\r\n"},"ports":[{"name":"in-max_file_size","displayName":"max_file_size","plug":"input","type":"*","group":"Inputs","index":4},{"name":"in-file","displayName":"file","plug":"input","type":"*","group":"Inputs","index":5},{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":6},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":7},{"name":"out-error","displayName":"error","plug":"output","type":"*","group":"Outputs","index":8},{"name":"out-response","displayName":"response","plug":"output","type":"*","group":"Outputs","index":9},{"name":"out-imageUrl","displayName":"imageUrl","plug":"output","type":"*","group":"Outputs","index":10}],"children":[]},{"id":"8a12f1a5-c292-2e6c-28db-7fd9968e0475","type":"Component Inputs","parameters":{},"ports":[],"children":[]},{"id":"4c79bb46-8c25-3889-7be0-5b06c3da9b65","type":"Component Outputs","parameters":{},"ports":[],"children":[]}],"connections":[{"sourceId":"8a12f1a5-c292-2e6c-28db-7fd9968e0475","sourcePort":"file","targetId":"6f60f65d-c6e1-2b35-2bb7-2363ad6ca194","targetPort":"in-file"},{"sourceId":"8a12f1a5-c292-2e6c-28db-7fd9968e0475","sourcePort":"Run","targetId":"6f60f65d-c6e1-2b35-2bb7-2363ad6ca194","targetPort":"run"},{"sourceId":"6f60f65d-c6e1-2b35-2bb7-2363ad6ca194","sourcePort":"out-imageUrl","targetId":"4c79bb46-8c25-3889-7be0-5b06c3da9b65","targetPort":"image_url"},{"sourceId":"6f60f65d-c6e1-2b35-2bb7-2363ad6ca194","sourcePort":"out-Success","targetId":"4c79bb46-8c25-3889-7be0-5b06c3da9b65","targetPort":"Success"},{"sourceId":"6f60f65d-c6e1-2b35-2bb7-2363ad6ca194","sourcePort":"out-response","targetId":"4c79bb46-8c25-3889-7be0-5b06c3da9b65","targetPort":"image_file"},{"sourceId":"6f60f65d-c6e1-2b35-2bb7-2363ad6ca194","sourcePort":"out-Failure","targetId":"4c79bb46-8c25-3889-7be0-5b06c3da9b65","targetPort":"Failure"},{"sourceId":"6f60f65d-c6e1-2b35-2bb7-2363ad6ca194","sourcePort":"out-error","targetId":"4c79bb46-8c25-3889-7be0-5b06c3da9b65","targetPort":"Error"}],"ports":[{"name":"image_url","type":"*","plug":"output","index":0},{"name":"file","type":"*","group":"Inputs","plug":"input","index":0},{"name":"Run","type":{"name":"signal","allowConnectionsOnly":true},"group":"Actions","plug":"input","index":1},{"name":"Success","type":"signal","plug":"output","index":2},{"name":"image_file","type":"*","plug":"output","index":3},{"name":"Failure","type":"signal","plug":"output","index":4},{"name":"Error","type":"*","plug":"output","index":5}],"roots":[]},{"name":"/Reuseables--0/misc/hard refresh","nodes":[{"id":"dd3dc82d-eb09-4b18-02bc-6863c8785722","type":"JavaScriptFunction","parameters":{"functionScript":"//hard refresh\r\nlocation.reload();\r\nOutputs.Success();"},"ports":[{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":4}],"children":[]},{"id":"2645a8dd-72c1-ad7f-7a95-82c13dad9b57","type":"Component Inputs","parameters":{},"ports":[],"children":[]},{"id":"ba89856d-60e9-02ab-d48d-3fd4e9925d9f","type":"Component Outputs","parameters":{},"ports":[],"children":[]}],"connections":[{"sourceId":"2645a8dd-72c1-ad7f-7a95-82c13dad9b57","sourcePort":"Run","targetId":"dd3dc82d-eb09-4b18-02bc-6863c8785722","targetPort":"run"},{"sourceId":"dd3dc82d-eb09-4b18-02bc-6863c8785722","sourcePort":"out-Success","targetId":"ba89856d-60e9-02ab-d48d-3fd4e9925d9f","targetPort":"Success"}],"ports":[{"name":"Run","type":{"name":"signal","allowConnectionsOnly":true},"group":"Actions","plug":"input","index":0},{"name":"Success","type":"signal","plug":"output","index":1}],"roots":[]}]